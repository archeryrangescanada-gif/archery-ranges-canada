require('dotenv').config({ path: '.env.local' });
const { createClient } = require('@supabase/supabase-js');

const supabase = createClient(
  process.env.NEXT_PUBLIC_SUPABASE_URL,
  process.env.SUPABASE_SERVICE_ROLE_KEY
);

const ALBERTA_RANGES = [
  {
    name: 'Southern Alberta Bowhunters Association (SABA)',
    slug: 'southern-alberta-bowhunters-association-saba',
    city: 'Lethbridge',
    address: 'Peenaquim Park, North Lethbridge',
    postal_code: null,
    latitude: 49.7214, longitude: -112.8354,
    phone_number: null,
    email: 'info@sababowhunters.ca',
    website: 'http://www.southernalbertabowhuntersassociation.ca/',
    post_content: 'Large outdoor range with block targets (20-100 yds) and 3D targets (5-100 yds).',
    post_tags: 'Outdoor, 3D, Bowhunting',
    business_hours: null,
    post_images: '{"/alberta listing images/southern_alberta_bowhunters_association_saba.jpg"}',
    range_length_yards: 100, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: true, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'Compound, Traditional',
    accessibility: 'Outdoor Access', parking_available: true
  },
  {
    name: 'Brazeau Bowbenders Archery Club',
    slug: 'brazeau-bowbenders-archery-club',
    city: 'Drayton Valley',
    address: 'Blue Rapids Provincial Recreation Area',
    postal_code: 'T7A 1S4',
    latitude: 53.2185, longitude: -114.9782,
    phone_number: '780-515-0220',
    email: 'info@bbarchery.ca',
    website: 'https://bbarchery.ca/',
    post_content: 'Outdoor range in Blue Rapids PRA and indoor facility at Tomahawk Ag Centre.',
    post_tags: 'Indoor, Outdoor, 3D',
    business_hours: null,
    post_images: '{"/alberta listing images/brazeau_bowbenders_archery_club.jpg"}',
    range_length_yards: 50, number_of_lanes: null,
    facility_type: 'Both',
    has_pro_shop: true, has_3d_course: true, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: true, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Cold Lake Fish and Game Club',
    slug: 'cold-lake-fish-and-game-club',
    city: 'Cold Lake',
    address: 'Range Road 434 & Hwy 55',
    postal_code: null,
    latitude: 54.4642, longitude: -110.1824,
    phone_number: '780-594-3302',
    email: null,
    website: 'https://coldlakefishandgame.com/',
    post_content: 'Archery field located 13.3km west of Cold Lake. Requires gate code.',
    post_tags: 'Outdoor, Target',
    business_hours: null,
    post_images: '{"/alberta listing images/cold_lake_fish_and_game_club.png"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Rural', parking_available: true
  },
  {
    name: 'Game Country Archers',
    slug: 'game-country-archers',
    city: 'Grande Prairie',
    address: 'Evergreen Park',
    postal_code: 'T8V 3R5',
    latitude: 55.1054, longitude: -118.7562,
    phone_number: '780-532-3279',
    email: null,
    website: 'https://gamecountryarchers.com/',
    post_content: 'Outdoor range and pavilion located at Evergreen Park.',
    post_tags: 'Outdoor, 3D',
    business_hours: null,
    post_images: '{"/alberta listing images/game_country_archers.png"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: true, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Park Access', parking_available: true
  },
  {
    name: 'Kneehill Bowhunters & Archers',
    slug: 'kneehill-bowhunters--archers',
    city: 'Trochu',
    address: 'Trochu Hall Basement',
    postal_code: 'T0M 2C0',
    latitude: 51.8267, longitude: -113.2217,
    phone_number: '403-350-7146',
    email: null,
    website: 'https://trochu.ab.ca/',
    post_content: 'Indoor range located in the basement of Trochu Hall.',
    post_tags: 'Indoor',
    business_hours: null,
    post_images: '{"/alberta listing images/kneehill_bowhunters_archers.jpg"}',
    range_length_yards: 20, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Parkland Bowbenders Archery Club',
    slug: 'parkland-bowbenders-archery-club',
    city: 'Spruce Grove',
    address: '80 Acres Wooded Land',
    postal_code: null,
    latitude: 53.5414, longitude: -114.0044,
    phone_number: '587-991-1268',
    email: 'info@parklandbowbenders.ca',
    website: 'https://parklandbowbenders.ca/',
    post_content: '80-acre wooded range with static and 3D loops open year-round.',
    post_tags: 'Outdoor, 3D',
    business_hours: '24/7 member access',
    post_images: '{"/alberta listing images/parkland_bowbenders_archery_club.png"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: true, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'Compound, Traditional',
    accessibility: 'Wooded', parking_available: true
  },
  {
    name: 'Sherwood Park Archery Club',
    slug: 'sherwood-park-archery-club',
    city: 'Sherwood Park',
    address: 'Birch Bay',
    postal_code: null,
    latitude: 53.5411, longitude: -113.2847,
    phone_number: '780-467-0085',
    email: 'info@sparchery.ca',
    website: 'https://sherwoodparckarchery.com/',
    post_content: 'Outdoor FITA and Field/3D range with trails and 24/7 access.',
    post_tags: 'Outdoor, FITA, 3D',
    business_hours: '24/7',
    post_images: '{"/alberta listing images/sherwood_park_archery_club.jpg"}',
    range_length_yards: 90, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: true, has_field_course: true,
    membership_required: true, membership_price_adult: 280, drop_in_price: null,
    equipment_rental_available: false, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Springbrook Archers',
    slug: 'springbrook-archers',
    city: 'Springbrook',
    address: 'Springbrook Multiplex',
    postal_code: 'T4S 1W4',
    latitude: 52.1814, longitude: -113.8824,
    phone_number: '403-638-7418',
    email: null,
    website: 'https://www.facebook.com/SpringbrookArchers',
    post_content: 'Family-run club in the Springbrook Multiplex training all ages.',
    post_tags: 'Indoor',
    business_hours: null,
    post_images: '{"/alberta listing images/springbrook_archers.jpg"}',
    range_length_yards: 20, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: true, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Stavely Archery Club',
    slug: 'stavely-archery-club',
    city: 'Stavely',
    address: 'Stavely Archery Lanes',
    postal_code: null,
    latitude: 50.1667, longitude: -113.6333,
    phone_number: null,
    email: null,
    website: 'https://stavelyarcherylanes.com/',
    post_content: 'Indoor range hosting 3D shoots and youth programs.',
    post_tags: 'Indoor, 3D',
    business_hours: null,
    post_images: '{"/alberta listing images/stavely_archery_club.jpg"}',
    range_length_yards: 20, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: false, has_3d_course: true, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: true, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Whitecourt Fish & Game Association',
    slug: 'whitecourt-fish--game-association',
    city: 'Whitecourt',
    address: 'WFGA Grounds',
    postal_code: null,
    latitude: 54.1439, longitude: -115.6828,
    phone_number: null,
    email: 'president@wfga.ca',
    website: 'https://wfga.ca/',
    post_content: 'Dedicated archery range maintained by the Fish & Game Association.',
    post_tags: 'Outdoor',
    business_hours: null,
    post_images: '{"/alberta listing images/whitecourt_fish_game_association.jpg"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Vermilion River Archers',
    slug: 'vermilion-river-archers',
    city: 'Vermilion',
    address: 'The Armouries Building',
    postal_code: null,
    latitude: 53.3533, longitude: -110.8522,
    phone_number: '780-581-3888',
    email: null,
    website: 'https://www.facebook.com/groups/471301010064186',
    post_content: 'Indoor club operating out of the historic Armouries building in Vermilion.',
    post_tags: 'Indoor',
    business_hours: null,
    post_images: '{"/alberta listing images/vermilion_river_archers.jpg"}',
    range_length_yards: 20, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Jim-Bows Archery Calgary',
    slug: 'jim-bows-archery-calgary',
    city: 'Calgary',
    address: '620 46 Ave NE #102',
    postal_code: 'T2E 8M9',
    latitude: 51.0942, longitude: -114.0454,
    phone_number: '403-250-7713',
    email: 'info@jimbowsarchery.ca',
    website: 'https://jimbowsarchery.ca/',
    post_content: 'Full-service pro shop with indoor lanes and 3D targets.',
    post_tags: 'Indoor, 3D, Pro Shop',
    business_hours: '10-8 Tue-Fri',
    post_images: '{"/alberta listing images/jim_bows_archery_calgary.jpg"}',
    range_length_yards: 20, number_of_lanes: 10,
    facility_type: 'Indoor',
    has_pro_shop: true, has_3d_course: true, has_field_course: false,
    membership_required: false, membership_price_adult: null, drop_in_price: 14.99,
    equipment_rental_available: true, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Archery World Calgary',
    slug: 'archery-world-calgary',
    city: 'Calgary',
    address: '3420 12th St NE #106',
    postal_code: 'T2E 6N1',
    latitude: 51.0834, longitude: -114.0254,
    phone_number: '403-910-6662',
    email: 'store@archeryworld.ca',
    website: 'https://archeryworld.ca/',
    post_content: 'Indoor range with 20, 30, and 40-yard lanes. Offers combat archery.',
    post_tags: 'Indoor, Combat',
    business_hours: 'Mon-Fri 10AM-9PM, Weekends 10AM-6PM',
    post_images: '{"/alberta listing images/archery_world_calgary.jpg"}',
    range_length_yards: 40, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: true, has_3d_course: true, has_field_course: false,
    membership_required: false, membership_price_adult: null, drop_in_price: 22,
    equipment_rental_available: true, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Calgary Archery Centre',
    slug: 'calgary-archery-centre',
    city: 'Calgary',
    address: '4855 47 St SE',
    postal_code: null,
    latitude: 50.9984, longitude: -113.9654,
    phone_number: '403-255-6830',
    email: 'info@calgaryarcherycentre.com',
    website: 'https://archershub.com/',
    post_content: "One of Calgary's largest indoor ranges with 10-40 yard targets.",
    post_tags: 'Indoor, 3D',
    business_hours: '11-9:30 Tue-Fri',
    post_images: '{"/alberta listing images/calgary_archery_centre.png"}',
    range_length_yards: 40, number_of_lanes: 30,
    facility_type: 'Indoor',
    has_pro_shop: true, has_3d_course: true, has_field_course: false,
    membership_required: false, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: true, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'CDTSA Milo Range',
    slug: 'cdtsa-milo-range',
    city: 'Milo',
    address: 'Southwest of Milo',
    postal_code: null,
    latitude: 50.5667, longitude: -112.8667,
    phone_number: null,
    email: 'info@cdtsa.ca',
    website: 'https://cdtsa.ca/',
    post_content: '160-acre members-only outdoor facility with two archery bays.',
    post_tags: 'Outdoor',
    business_hours: '9-9 Daily',
    post_images: '{"/alberta listing images/cdtsa_milo_range.png"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Cochrane Archery Club',
    slug: 'cochrane-archery-club',
    city: 'Cochrane',
    address: 'Hwy 1A & RR 43',
    postal_code: null,
    latitude: 51.1892, longitude: -114.4678,
    phone_number: '403-932-4143',
    email: 'info@cochranearchery.ca',
    website: 'https://cochranearchery.ca/',
    post_content: 'Non-profit club with 10-40m indoor lanes and 50m outdoor range.',
    post_tags: 'Indoor, Outdoor, 3D',
    business_hours: 'Mon/Thu 7-9',
    post_images: '{"/alberta listing images/cochrane_archery_club.jpg"}',
    range_length_yards: 50, number_of_lanes: null,
    facility_type: 'Both',
    has_pro_shop: false, has_3d_course: true, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: true, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'AHEIA Archery Range',
    slug: 'aheia-archery-range',
    city: 'Calgary',
    address: 'AHEIA Conservation Center',
    postal_code: null,
    latitude: 51.0447, longitude: -114.0719,
    phone_number: '403-256-0665',
    email: 'cfc@aheia.com',
    website: 'https://aheia.com/',
    post_content: 'Dedicated archery range within an 80-acre conservation area.',
    post_tags: 'Outdoor',
    business_hours: null,
    post_images: '{"/alberta listing images/aheia_archery_range.png"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Jim-Bows Archery Edmonton',
    slug: 'jim-bows-archery-edmonton',
    city: 'Edmonton',
    address: '13955 156 St NW',
    postal_code: 'T6V 1J1',
    latitude: 53.6014, longitude: -113.5854,
    phone_number: '780-488-7705',
    email: 'edmonton@jimbowsarchery.ca',
    website: 'https://jimbowsarchery.ca/',
    post_content: 'Edmonton branch of Jim-Bows featuring indoor target lanes.',
    post_tags: 'Indoor, Pro Shop',
    business_hours: 'Tue-Fri 10AM-8PM, Sat 10AM-5PM',
    post_images: '{"/alberta listing images/jim_bows_archery_edmonton.jpg"}',
    range_length_yards: 20, number_of_lanes: 10,
    facility_type: 'Indoor',
    has_pro_shop: true, has_3d_course: false, has_field_course: false,
    membership_required: false, membership_price_adult: null, drop_in_price: 14.99,
    equipment_rental_available: true, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Capital Region Archery Club',
    slug: 'capital-region-archery-club',
    city: 'Edmonton',
    address: '5618 76 Ave NW',
    postal_code: 'T6B 0A6',
    latitude: 53.5114, longitude: -113.4254,
    phone_number: '780-450-6041',
    email: 'crac.membership@gmail.com',
    website: 'https://crarchery.ca/',
    post_content: 'Volunteer-run indoor range with 24-hour access for members.',
    post_tags: 'Indoor',
    business_hours: '24/7 Members',
    post_images: '{"/alberta listing images/capital_region_archery_club.jpg"}',
    range_length_yards: 20, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Camrose Shooting Sports Association',
    slug: 'camrose-shooting-sports-association',
    city: 'Camrose',
    address: 'CSSA Grounds',
    postal_code: null,
    latitude: 53.0233, longitude: -112.8333,
    phone_number: null,
    email: 'cssa2014@hotmail.com',
    website: 'https://camroseshootingsports.ca/',
    post_content: 'Indoor range available for scheduled archery sessions.',
    post_tags: 'Indoor',
    business_hours: null,
    post_images: '{"/alberta listing images/camrose_shooting_sports_association.jpg"}',
    range_length_yards: 20, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Lloydminster & Area Archers',
    slug: 'lloydminster--area-archers',
    city: 'Lloydminster',
    address: 'LAA Youth Center',
    postal_code: null,
    latitude: 53.2783, longitude: -110.0050,
    phone_number: null,
    email: 'membership.lloydarchers@gmail.com',
    website: 'https://lloydarchers.ca/',
    post_content: 'Indoor range up to 40 yards and a seasonal outdoor 3D course.',
    post_tags: 'Indoor, Outdoor, 3D',
    business_hours: null,
    post_images: '{"/alberta listing images/lloydminster_area_archers.png"}',
    range_length_yards: 40, number_of_lanes: 18,
    facility_type: 'Both',
    has_pro_shop: false, has_3d_course: true, has_field_course: true,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Storm Mountain Outfitters',
    slug: 'storm-mountain-outfitters',
    city: 'Stettler',
    address: 'Storm Mountain Grounds',
    postal_code: null,
    latitude: 52.3167, longitude: -112.7167,
    phone_number: '403-740-3000',
    email: 'info@stormmountainoutfitters.ca',
    website: 'https://stormmountainoutfitters.ca/',
    post_content: 'Commercial indoor archery range and professional outfitter.',
    post_tags: 'Indoor, Pro Shop',
    business_hours: 'Mon-Sat 9AM-6PM',
    post_images: '{"/alberta listing images/storm_mountain_outfitters.jpg"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: true, has_3d_course: false, has_field_course: false,
    membership_required: false, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Grande Central Archery',
    slug: 'grande-central-archery',
    city: 'Red Deer',
    address: '7km South of Red Deer',
    postal_code: null,
    latitude: 52.2681, longitude: -113.8111,
    phone_number: null,
    email: 'grandecentralarchery@gmail.com',
    website: 'https://grandecentralarchery.ca/',
    post_content: 'Indoor range with 20 and 35-yard lanes and full service shop.',
    post_tags: 'Indoor, Pro Shop',
    business_hours: null,
    post_images: '{"/alberta listing images/grande_central_archery.png"}',
    range_length_yards: 35, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: true, has_3d_course: false, has_field_course: false,
    membership_required: false, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: true, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Red Deer Fish and Game Association',
    slug: 'red-deer-fish-and-game-association',
    city: 'Red Deer',
    address: 'RDFGA Grounds',
    postal_code: null,
    latitude: 52.2681, longitude: -113.8111,
    phone_number: '403-588-5108',
    email: 'archery@reddeerfishandgame.com',
    website: 'https://reddeerfishandgame.com/',
    post_content: 'Multipurpose outdoor range with dedicated archery sections.',
    post_tags: 'Outdoor',
    business_hours: null,
    post_images: '{"/alberta listing images/red_deer_fish_and_game_association.jpg"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Taber Archers & Bowhunters',
    slug: 'taber-archers--bowhunters',
    city: 'Taber',
    address: 'MD of Taber Shooting Complex',
    postal_code: 'T0K 0B0',
    latitude: 49.7833, longitude: -112.1500,
    phone_number: '403-382-5717',
    email: 'secretary@shoot-taber.org',
    website: 'https://taberrange-md.com/',
    post_content: "3D archery range within Western Canada's largest shooting complex.",
    post_tags: 'Outdoor, 3D',
    business_hours: null,
    post_images: '{"/alberta listing images/taber_archers_bowhunters.png"}',
    range_length_yards: 100, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: true, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Medicine Hat SAAMIS Archers',
    slug: 'medicine-hat-saamis-archers',
    city: 'Medicine Hat',
    address: 'Medicine Hat Archery Club',
    postal_code: 'T1A 0H1',
    latitude: 50.0411, longitude: -110.6778,
    phone_number: '403-581-1656',
    email: 'medhatarcheryclub@gmail.com',
    website: 'https://medicinehatarchery.ca/',
    post_content: 'Club with 24/7 indoor range access and a 100yd outdoor range.',
    post_tags: 'Indoor, Outdoor',
    business_hours: '24/7 Members',
    post_images: '{"/alberta listing images/medicine_hat_saamis_archers.jpg"}',
    range_length_yards: 100, number_of_lanes: null,
    facility_type: 'Both',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Dragon Flight Archery',
    slug: 'dragon-flight-archery',
    city: 'Cremona',
    address: 'Range Rd 55',
    postal_code: 'T0M 0R0',
    latitude: 51.5439, longitude: -114.4886,
    phone_number: '403-637-0266',
    email: 'dragonflightarchery@protonmail.com',
    website: 'https://dragonflightarchery.co/',
    post_content: 'FOOTHILLS based range offering lessons and rentals near Water Valley.',
    post_tags: 'Indoor/Outdoor',
    business_hours: null,
    post_images: '{"/alberta listing images/dragon_flight_archery.jpg"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Both',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: false, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: true, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Foothills', parking_available: true
  },
  {
    name: 'Picture Butte Archery Association',
    slug: 'picture-butte-archery-association',
    city: 'Picture Butte',
    address: 'Coulees Near Picture Butte',
    postal_code: null,
    latitude: 49.8833, longitude: -112.7833,
    phone_number: '403-332-1375',
    email: 'thebushman40@yahoo.ca',
    website: 'https://pbfishandgame.com/',
    post_content: 'Outdoor 3D shoots held in the coulees; Junior and Senior programs.',
    post_tags: 'Outdoor, 3D',
    business_hours: null,
    post_images: '{"/alberta listing images/picture_butte_archery_association.jpg"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: true, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Coulees', parking_available: true
  },
  {
    name: 'Ponoka & Area Archers Club',
    slug: 'ponoka--area-archers-club',
    city: 'Ponoka',
    address: 'Moose Hall, 5000 AB-2A',
    postal_code: 'T4J 1R7',
    latitude: 52.6667, longitude: -113.5833,
    phone_number: '403-783-1723',
    email: 'paacmemberfees@gmail.com',
    website: 'https://ponokaandareaarchersclub.ca/',
    post_content: 'Indoor range located at the Moose Hall on the east side of Hwy 2A.',
    post_tags: 'Indoor',
    business_hours: null,
    post_images: '{"/alberta listing images/ponoka_area_archers_club.jpg"}',
    range_length_yards: 20, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Foothills Archery Club',
    slug: 'foothills-archery-club',
    city: 'Millarville',
    address: 'Millarville Area',
    postal_code: null,
    latitude: 50.7333, longitude: -114.2833,
    phone_number: null,
    email: 'fac.directors@gmail.com',
    website: 'https://foothillarcheryclub.wordpress.com/',
    post_content: 'Non-profit volunteer club with range activities in the Millarville area.',
    post_tags: 'Outdoor, 3D',
    business_hours: null,
    post_images: '{"/alberta listing images/foothills_archery_club.jpg"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: true, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Outlaw Archery Club',
    slug: 'outlaw-archery-club',
    city: 'Vauxhall',
    address: 'Vauxhall/Taber Area',
    postal_code: null,
    latitude: 50.0500, longitude: -112.1333,
    phone_number: null,
    email: null,
    website: 'https://archeryalberta.ca/',
    post_content: 'Active club hosting events at regional shooting complexes.',
    post_tags: 'Indoor/Outdoor',
    business_hours: null,
    post_images: '{"/alberta listing images/outlaw_archery_club.png"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Both',
    has_pro_shop: false, has_3d_course: true, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Carbon Archery Range',
    slug: 'carbon-archery-range',
    city: 'Carbon',
    address: '237 Caradoc Ave',
    postal_code: 'T0M 0L0',
    latitude: 51.4878, longitude: -113.1553,
    phone_number: '403-823-1963',
    email: 'carboncurlingclub.ag@gmail.com',
    website: 'https://kneehillcounty.com/',
    post_content: 'Indoor range located in the Carbon Curling Rink facility.',
    post_tags: 'Indoor',
    business_hours: null,
    post_images: '{"/alberta listing images/carbon_archery_range.jpg"}',
    range_length_yards: 20, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Garrison Archery Club',
    slug: 'garrison-archery-club',
    city: 'Edmonton',
    address: 'CFB Edmonton Range',
    postal_code: 'T0A 2H0',
    latitude: 53.6667, longitude: -113.4667,
    phone_number: null,
    email: 'Darryl.Poisson@forces.gc.ca',
    website: 'https://cfmws.ca/',
    post_content: 'Archery club for military and civilians at the Garrison range.',
    post_tags: 'Outdoor',
    business_hours: null,
    post_images: '{"/alberta listing images/garrison_archery_club.jpg"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'CFB Base', parking_available: true
  },
  {
    name: 'Archer VS Archer',
    slug: 'archer-vs-archer',
    city: 'Edmonton',
    address: '8128 46 St NW',
    postal_code: 'T6B 2M8',
    latitude: 53.5181, longitude: -113.4150,
    phone_number: '587-594-5733',
    email: 'admin@archervsarcher.ca',
    website: 'https://archervsarcher.ca/',
    post_content: 'Dedicated combat archery and tag facility in Edmonton.',
    post_tags: 'Indoor, Combat',
    business_hours: null,
    post_images: '{"/alberta listing images/archer_vs_archer.png"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: false, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: true, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'Tag Only',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: "Cabela's Edmonton North",
    slug: 'cabelas-edmonton-north',
    city: 'Edmonton',
    address: '15320 37 St NW',
    postal_code: 'T5Y 0S5',
    latitude: 53.6167, longitude: -113.3833,
    phone_number: '780-670-6100',
    email: 'info@cabelas.ca',
    website: 'https://cabelas.ca/',
    post_content: 'Commercial retail location with indoor archery test lanes.',
    post_tags: 'Indoor, Retail',
    business_hours: null,
    post_images: '{"/alberta listing images/cabelas_edmonton_north.jpg"}',
    range_length_yards: 20, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: true, has_3d_course: false, has_field_course: false,
    membership_required: false, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: true, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: "Cabela's Edmonton South",
    slug: 'cabelas-edmonton-south',
    city: 'Edmonton',
    address: '6150 Currents Dr NW',
    postal_code: 'T6W 0L7',
    latitude: 53.4333, longitude: -113.6000,
    phone_number: '780-628-9200',
    email: 'info@cabelas.ca',
    website: 'https://cabelas.ca/',
    post_content: 'Commercial retail location with indoor archery test lanes.',
    post_tags: 'Indoor, Retail',
    business_hours: null,
    post_images: '{"/alberta listing images/cabelas_edmonton_south.jpg"}',
    range_length_yards: 20, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: true, has_3d_course: false, has_field_course: false,
    membership_required: false, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: true, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Lodgepole Outdoors',
    slug: 'lodgepole-outdoors',
    city: 'Edmonton',
    address: '7601 91 Ave NW',
    postal_code: 'T6C 1P7',
    latitude: 53.5267, longitude: -113.4333,
    phone_number: null,
    email: null,
    website: 'https://lodgepoleoutdoors.com/',
    post_content: 'Local outdoors shop and guide service with archery facilities.',
    post_tags: 'Indoor/Outdoor',
    business_hours: null,
    post_images: '{"/alberta listing images/lodgepole_outdoors.jpg"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Both',
    has_pro_shop: true, has_3d_course: false, has_field_course: false,
    membership_required: false, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'CHAS Genesee Range',
    slug: 'chas-genesee-range',
    city: 'Edmonton',
    address: 'Genesee Range',
    postal_code: null,
    latitude: 53.3333, longitude: -114.2833,
    phone_number: null,
    email: 'archery@historical-arms.com',
    website: 'https://chascollectors.com/',
    post_content: 'Large shooting range complex with dedicated archery lanes.',
    post_tags: 'Outdoor',
    business_hours: null,
    post_images: '{"/alberta listing images/chas_genesee_range.jpg"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Lethbridge Bowbenders Archery Club',
    slug: 'lethbridge-bowbenders-archery-club',
    city: 'Lethbridge',
    address: '545 30 St N',
    postal_code: null,
    latitude: 49.7042, longitude: -112.8080,
    phone_number: null,
    email: 'lethbridgebowbenders@gmail.com',
    website: 'https://lethbridgebowbenders.com/',
    post_content: 'Dedicated target archery club with indoor facility and junior programs.',
    post_tags: 'Indoor',
    business_hours: null,
    post_images: '{"/alberta listing images/lethbridge_bowbenders_archery_club.jpg"}',
    range_length_yards: 20, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Lethbridge Fish and Game Association',
    slug: 'lethbridge-fish-and-game-association',
    city: 'Lethbridge',
    address: 'Peenaquim Park',
    postal_code: null,
    latitude: 49.7214, longitude: -112.8354,
    phone_number: '403-382-0914',
    email: 'range.operator@lfga.club',
    website: 'https://lethbridgefishandgame.ca/',
    post_content: 'Large outdoor sports facility with dedicated target and 3D archery ranges.',
    post_tags: 'Outdoor, 3D',
    business_hours: 'Member access',
    post_images: '{"/alberta listing images/lethbridge_fish_and_game_association.jpg"}',
    range_length_yards: null, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: true, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Heisler Archery Club',
    slug: 'heisler-archery-club',
    city: 'Heisler',
    address: '302 Haultain Ave',
    postal_code: null,
    latitude: 52.6414, longitude: -112.2086,
    phone_number: '780-678-0599',
    email: null,
    website: 'https://villageofheisler.ca/',
    post_content: 'Seasonal indoor range (Nov-Apr) located in the Heisler Bowling Alley.',
    post_tags: 'Indoor',
    business_hours: 'Seasonal',
    post_images: '{"/alberta listing images/heisler_archery_club.png"}',
    range_length_yards: 20, number_of_lanes: null,
    facility_type: 'Indoor',
    has_pro_shop: false, has_3d_course: false, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: true, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Taber Shooting Foundation Archery',
    slug: 'taber-shooting-foundation-archery',
    city: 'Taber',
    address: '104083 HWY 864',
    postal_code: 'T0K 0B0',
    latitude: 49.7833, longitude: -112.1500,
    phone_number: '403-634-4958',
    email: 'secretary@shoot-taber.org',
    website: 'https://taberrange-md.com/',
    post_content: 'Comprehensive 3D archery range within the MD of Taber Sport Shooting Complex.',
    post_tags: 'Outdoor, 3D',
    business_hours: null,
    post_images: '{"/alberta listing images/taber_shooting_foundation_archery.png"}',
    range_length_yards: 100, number_of_lanes: null,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: true, has_field_course: false,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Standard', parking_available: true
  },
  {
    name: 'Calgary Archers Outdoor Range',
    slug: 'calgary-archers-outdoor-range',
    city: 'Cochrane',
    address: '15m North of Cochrane',
    postal_code: null,
    latitude: 51.3500, longitude: -114.4833,
    phone_number: '403-259-5505',
    email: 'info@calgaryarchers.com',
    website: 'https://calgaryarchers.com/',
    post_content: 'New outdoor range facility featuring FITA, Field, and 3D courses.',
    post_tags: 'Outdoor, FITA, 3D',
    business_hours: null,
    post_images: '{"/alberta listing images/calgary_archers_outdoor_range.png"}',
    range_length_yards: 90, number_of_lanes: 24,
    facility_type: 'Outdoor',
    has_pro_shop: false, has_3d_course: true, has_field_course: true,
    membership_required: true, membership_price_adult: null, drop_in_price: null,
    equipment_rental_available: false, lessons_available: false, lesson_price_range: null,
    bow_types_allowed: 'All',
    accessibility: 'Rural', parking_available: true
  }
];

async function getOrCreateCity(cityName, provinceId) {
  const citySlug = cityName.toLowerCase().replace(/[^a-z0-9\s-]/g, '').replace(/\s+/g, '-');

  const { data: existing } = await supabase
    .from('cities')
    .select('id')
    .ilike('name', cityName)
    .eq('province_id', provinceId)
    .single();

  if (existing) return existing.id;

  const { data: created, error } = await supabase
    .from('cities')
    .insert({ name: cityName, slug: citySlug, province_id: provinceId })
    .select('id')
    .single();

  if (error) throw new Error(`Failed to create city ${cityName}: ${error.message}`);
  return created.id;
}

async function deploy() {
  console.log('=== DEPLOYING 43 ALBERTA ARCHERY RANGES ===\n');

  // Get Alberta province ID
  const { data: province, error: provError } = await supabase
    .from('provinces')
    .select('id')
    .or('slug.eq.alberta,name.ilike.Alberta')
    .single();

  if (provError || !province) {
    console.error('Alberta province not found:', provError);
    return;
  }

  const provinceId = province.id;
  console.log(`Alberta province_id: ${provinceId}\n`);

  let successCount = 0;
  let updateCount = 0;
  let failCount = 0;

  for (const range of ALBERTA_RANGES) {
    try {
      const cityId = await getOrCreateCity(range.city, provinceId);

      // Check if range already exists
      const { data: existing } = await supabase
        .from('ranges')
        .select('id')
        .eq('slug', range.slug)
        .eq('city_id', cityId)
        .single();

      const rangeData = {
        name: range.name,
        slug: range.slug,
        city_id: cityId,
        province_id: provinceId,
        address: range.address,
        postal_code: range.postal_code,
        latitude: range.latitude,
        longitude: range.longitude,
        phone_number: range.phone_number,
        email: range.email,
        website: range.website,
        post_content: range.post_content,
        post_tags: range.post_tags,
        business_hours: range.business_hours,
        post_images: range.post_images,
        range_length_yards: range.range_length_yards,
        number_of_lanes: range.number_of_lanes,
        facility_type: range.facility_type,
        has_pro_shop: range.has_pro_shop,
        has_3d_course: range.has_3d_course,
        has_field_course: range.has_field_course,
        membership_required: range.membership_required,
        membership_price_adult: range.membership_price_adult,
        drop_in_price: range.drop_in_price,
        equipment_rental_available: range.equipment_rental_available,
        lessons_available: range.lessons_available,
        lesson_price_range: range.lesson_price_range,
        bow_types_allowed: range.bow_types_allowed,
        accessibility: range.accessibility,
        parking_available: range.parking_available,
        subscription_tier: 'free',
        is_featured: false,
        is_claimed: false,
        is_premium: false
      };

      if (existing) {
        const { error: updateError } = await supabase
          .from('ranges')
          .update(rangeData)
          .eq('id', existing.id);

        if (updateError) {
          console.error(`FAILED to update "${range.name}": ${updateError.message}`);
          failCount++;
        } else {
          console.log(`UPDATED: ${range.name} (${range.city})`);
          updateCount++;
        }
      } else {
        const { error: insertError } = await supabase
          .from('ranges')
          .insert(rangeData);

        if (insertError) {
          console.error(`FAILED to insert "${range.name}": ${insertError.message}`);
          failCount++;
        } else {
          console.log(`INSERTED: ${range.name} (${range.city})`);
          successCount++;
        }
      }
    } catch (err) {
      console.error(`ERROR processing "${range.name}": ${err.message}`);
      failCount++;
    }
  }

  console.log('\n' + '='.repeat(60));
  console.log('DEPLOYMENT SUMMARY:');
  console.log(`  New inserts: ${successCount}`);
  console.log(`  Updates: ${updateCount}`);
  console.log(`  Failed: ${failCount}`);
  console.log(`  Total processed: ${ALBERTA_RANGES.length}`);
  console.log('='.repeat(60));
}

deploy()
  .then(() => {
    console.log('\nDone!');
    process.exit(0);
  })
  .catch(err => {
    console.error('\nFatal error:', err);
    process.exit(1);
  });
